var GroupConsts=function(){function t(){}var e=(__define,t);return p=e.prototype,t.Lobby="lobby",t}();egret.registerClass(GroupConsts,"GroupConsts");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},p.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.start=function(t){uniLib.init(!0),this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},p.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},p.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),uniLib.ResLoadMgr.instance.load(GroupConsts.Lobby,this.onLoadLobbySucc,this.onLoadLobbyFail,this,LobbyLoading))},p.onLoadLobbySucc=function(){uniLib.UIMgr.instance.showLoading(LobbyLoading,"开始连接服务器...");RES.getRes("config_json");this.onSockInitSucc()},p.onHttpInitSucc=function(){uniLib.NetMgr.initSocket(this.onSockInitSucc,this.onSockInitFail,this)},p.onHttpInitFail=function(){},p.onSockInitSucc=function(){uniLib.SceneMgr.instance.changeScene(LobbyScene)},p.onSockInitFail=function(){},p.onLoadLobbyFail=function(){},p.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},p.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},p.createGameScene=function(){var t=this.createBitmapByName("bgImage");this.addChild(t);var e=this.stage.stageWidth,i=this.stage.stageHeight;t.width=e,t.height=i;var n=new egret.Shape;n.graphics.beginFill(0,.5),n.graphics.drawRect(0,0,e,i),n.graphics.endFill(),n.width=e,n.height=i,this.addChild(n);var s=this.createBitmapByName("egretIcon");this.addChild(s),s.scaleX=.55,s.scaleY=.55,s.anchorOffsetX=s.width/2,s.anchorOffsetY=s.height/2,s.x=e/2,s.y=i/2-60;var o=new egret.TextField;o.textColor=16777215,o.textAlign="center",o.text="Hello Egret",o.size=20,o.x=e-o.width>>1,o.y=(i-o.height>>1)+50,this.addChild(o);var a=new egret.TextField;this.addChild(a),a.alpha=0,a.width=e,a.textAlign=egret.HorizontalAlign.CENTER,a.x=0,a.y=i/2+100,this.textfield=a,RES.getResAsync("description",this.startAnimation,this)},p.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},p.startAnimation=function(t){for(var e=this,i=new egret.HtmlTextParser,n=[],s=0;s<t.length;s++)n.push(i.parser(t[s]));var o=e.textfield,a=-1,h=function(){a++,a>=n.length&&(a=0);var t=n[a];e.changeDescription(o,t);var i=egret.Tween.get(o);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(h,e)};h()},p.changeDescription=function(t,e){t.textFlow=e},e}(uniLib.LobbyScene);egret.registerClass(Main,"Main");var LobbyScene=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.awake=function(){this._gameList=new LobbyGameList,this.uiLayer.addChild(this._gameList),this._bottomMenu=new LobbyMenu,this._bottomMenu.y=uniLib.Global.screenHeight-this._bottomMenu.height,this.uiLayer.addChild(this._bottomMenu)},p.start=function(){uniLib.Console.error("被添加到舞台")},p.resize=function(){this._bottomMenu.y=uniLib.Global.screenHeight-this._bottomMenu.height},e}(uniLib.LobbyScene);egret.registerClass(LobbyScene,"LobbyScene");var LobbyMenuButton=function(t){function e(e,i,n,s,o,a){void 0===a&&(a=16777215),t.call(this,e,i,n,null,null,s,o,a)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(e,i,n,s,o,a,h,r){void 0===r&&(r=16777215),t.prototype.init.call(this,e,i,n,s,o,a,h,r),this._lable.y=this._nomal_bg.y+this._nomal_bg.height+10,this._lable.x=this._nomal_bg.width-this._lable.width>>1},e}(uniLib.SimpleButton);egret.registerClass(LobbyMenuButton,"LobbyMenuButton");var LoadGameLoading=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){null==this._bg&&(this._bg=new egret.Sprite,this._bg.graphics.clear(),this._bg.graphics.beginFill(0,.8),this._bg.graphics.drawRect(0,0,uniLib.Global.screenWidth,uniLib.Global.screenHeight),this._bg.graphics.endFill(),this._bg.width=uniLib.Global.screenWidth,this._bg.height=uniLib.Global.screenHeight,this._bg.touchEnabled=!0,egret.Tween.get(this._bg).to({alpha:1},100),this._bg.visible=!0),this.addChild(this._bg),this._loadGameWait=uniLib.ResUtils.createBitmapByName("lobby_Wait_png"),this._loadGameWait.anchorOffsetX=this._loadGameWait.width>>1,this._loadGameWait.anchorOffsetY=this._loadGameWait.height>>1,this._loadGameWait.x=uniLib.Global.screenWidth>>1,this._loadGameWait.y=uniLib.Global.screenHeight-this._loadGameWait.height>>1,this.addChild(this._loadGameWait),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)},p.onAddToStage=function(t){egret.Tween.get(this._loadGameWait,{loop:!0}).to({rotation:360},2e3),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this)},p.onRemoveFromStage=function(t){egret.Tween.removeTweens(this._loadGameWait),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this)},e}(egret.Sprite);egret.registerClass(LoadGameLoading,"LoadGameLoading");var LobbyLoading=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){this.percentTxt=new egret.TextField,this.percentTxt.size=30,this.percentTxt.text="正在加载游戏资源 1%",this.bg=uniLib.ResUtils.createBitmapByName("lobby_loading_bg_jpg"),this.addChild(this.bg),this.percentTxt.x=(uniLib.Global.screenWidth-this.percentTxt.width)/2,this.percentTxt.y=740,this.addChild(this.percentTxt)},p.setProgress=function(t){this.percentTxt.text=t,this.percentTxt.x=(uniLib.Global.screenWidth-this.percentTxt.width)/2},e}(egret.Sprite);egret.registerClass(LobbyLoading,"LobbyLoading");var LobbyGameItem=function(t){function e(e,i,n){t.call(this),i&&(this.width=i),n&&(this.height=n),this.touchEnabled=!0,this.data=e}__extends(e,t);var i=__define,n=e;return p=n.prototype,i(p,"img",void 0,function(t){RES.getResByUrl(t,this.onComplete,this,RES.ResourceItem.TYPE_IMAGE)}),p.onComplete=function(t){var e=t;this._itemBg=new egret.Bitmap(e),(this.width>0||this.height>0)&&(this._itemBg.width=this.width,this._itemBg.height=this.height),this.addChild(this._itemBg)},i(p,"data",function(){return this._gameConfig},function(t){this._gameConfig=t,t.gameIconUrl&&(this.img=t.gameIconUrl)}),e}(egret.Sprite);egret.registerClass(LobbyGameItem,"LobbyGameItem");var LobbyGameList=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){for(var t=RES.getRes("gameList_json"),e=0;e<t.length;e++){var i=new LobbyGameItem(t[e],310,268);e%2==0?i.x=8:i.x=i.width+12,i.y=8+Math.floor(e/2)*(i.height+5),this.addChild(i)}this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickGameItem,this)},p.onClickGameItem=function(t){var e=t.target;if(e){var i=e.data;uniLib.GameModuleUtils.LoadGame(i.gameCodeUrl,i.gameDoc,i,LoadGameLoading)}},e}(egret.Sprite);egret.registerClass(LobbyGameList,"LobbyGameList");var LobbyMenu=function(t){function e(){t.call(this),this.init()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){this._homeBtn=new uniLib.SimpleButton("lobby_bottomBar_logoIcon_png"),this._homeBtn.anchorOffsetX=this._homeBtn.width>>1,this._homeBtn.x=uniLib.Global.screenWidth>>1,this._bg=uniLib.ResUtils.createBitmapByName("lobby_bottomBar_bg_png"),this._bg.width=uniLib.Global.screenWidth,this._bg.y=this._homeBtn.height-this._bg.height,this.addChild(this._bg),this.addChild(this._homeBtn),this._avar=new egret.Bitmap,this._avarMask=uniLib.ResUtils.createBitmapByName("lobby_bottomBar_headFrame_png"),this._avarMask.y=this.height-this._avarMask.height,this._avar.y=this._avarMask.y,this.addChild(this._avar),this.addChild(this._avarMask),this._bagBtn=new LobbyMenuButton("lobby_bottomBar_bagIcon_png",null,null,"背包",26),this._bagBtn.x=this._homeBtn.x+120,this._bagBtn.y=(this.height-this._bagBtn.height>>1)+15,this.addChild(this._bagBtn),this._moreBtn=new LobbyMenuButton("lobby_bottomBar_bagIcon_png",null,null,"更多",26),this._moreBtn.x=this._bagBtn.x+this._bagBtn.width+50,this._moreBtn.y=(this.height-this._moreBtn.height>>1)+15,this.addChild(this._moreBtn),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},p.onClick=function(t){var e=t.target;e==this._homeBtn&&console.error("home")},e}(egret.DisplayObjectContainer);egret.registerClass(LobbyMenu,"LobbyMenu");var LobbyWait=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.init=function(){null==this.waitBmp&&(this.waitBmp=uniLib.ResUtils.createBitmapByName("Wait"),this.waitBmp.anchorOffsetX=this.waitBmp.width/2,this.waitBmp.anchorOffsetY=this.waitBmp.height/2,this.waitBmp.scaleX=this.waitBmp.scaleY=.3,this.waitBmp.x=uniLib.Global.screenWidth/2,this.waitBmp.y=uniLib.Global.screenHeight/2),null==this.waitMask&&(this.waitMask=new egret.Sprite,this.waitMask.graphics.clear(),this.waitMask.graphics.beginFill(0,.3),this.waitMask.graphics.drawRect(0,0,uniLib.Global.screenWidth,uniLib.Global.screenHeight),this.waitMask.graphics.endFill(),this.waitMask.width=uniLib.Global.screenWidth,this.waitMask.height=uniLib.Global.screenHeight,this.waitMask.touchEnabled=!0,egret.Tween.get(this.waitMask).to({alpha:1},100),this.waitMask.visible=!0),this.addChild(this.waitMask),this.addChild(this.waitBmp),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)},p.onAddToStage=function(t){egret.Tween.get(this.waitBmp,{loop:!0}).to({rotation:360},2e3),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRmoveFromStage,this)},p.onRmoveFromStage=function(t){egret.Tween.removeTweens(this.waitBmp),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRmoveFromStage,this)},e}(egret.Sprite);egret.registerClass(LobbyWait,"LobbyWait");